You want to extract the data from a tableau workbook using python code
You will ultimately want this code to be a dagster asset. 
Lets start with a notebook to test and see what data is found in the download
put the notebook in worflows/public/notebooks
name the notebook "sandiego_epideimilogy.ipynb"
put the downloaded workbook and extracted data in  data/sandiego_epideimilogy

the tabelau development dashboard you want to extract the data from
is at:
https://public.tableau.com/views/DraftRespDash/RespDash


For production this will be changed, so set a variable at the top of the asset we can easily change

there is a download button that brings up a dialog with a 'Tableau Workbook'

It looks like the link is: https://public.tableau.com/workbooks/DraftRespDash.twb

here is javascript code to get the file:
```
const session = "1E758B7D85794E1CAA96EAD19C3A5D00-0:0"; // needs to be generated by visiting webpage
const documentId = "{6F324CCD-B1F2-4F80-AA86-8AD270C97348}"; // static across sessions, this one points to the time series data

// Get a key that lets us download the csv
fetch(`https://public.tableau.com/vizql/w/DraftRespDash/v/RespDash/sessions/${session}/commands/tabsrv/export-crosstab-to-csvserver`, {
  "headers": {
    "accept": "text/javascript",
    "accept-language": "en-US,en;q=0.7",
    "content-type": "multipart/form-data; boundary=TLArn3Eh",
    "priority": "u=1, i",
    "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Brave\";v=\"138\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"macOS\"",
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "same-origin",
    "sec-gpc": "1",
    "x-b3-sampled": "1",
    "x-b3-spanid": "c180f182fd95a5c62ebed54a81b95496",
    "x-b3-traceid": "08a0e4af3296bae9c4434f0ba7932849",
    "x-requested-with": "XMLHttpRequest",
    "x-tableau-version": "2025.2",
    "x-tsi-active-tab": "RespDash"
  },
  "referrer": "https://public.tableau.com/views/DraftRespDash/RespDash?%3Adisplay_static_image=y&%3AbootstrapWhenNotified=true&%3Aembed=true&%3Alanguage=en-US&:embed=y&:showVizHome=n&:apiID=host0",
  "body": "--TLArn3Eh\r\nContent-Disposition: form-data; name=\"sheetdocId\"\r\n\r\n"+ documentId +"\r\n--TLArn3Eh\r\nContent-Disposition: form-data; name=\"useTabs\"\r\n\r\ntrue\r\n--TLArn3Eh\r\nContent-Disposition: form-data; name=\"sendNotifications\"\r\n\r\ntrue\r\n--TLArn3Eh\r\nContent-Disposition: form-data; name=\"telemetryCommandId\"\r\n\r\n1j18vivat$6u0j-8k-ge-rg-t656ko\r\n--TLArn3Eh--\r\n",
  "method": "POST",
  "mode": "cors",
  "credentials": "include"
})

.then(res => res.json())

.then(json => {
    const key = json.vqlCmdResponse.layoutStatus.applicationPresModel.presentationLayerNotification[0].presModelHolder.genExportFilePresModel.resultKey;
    console.log("key", key);
    return key;
})

// Use key to download document
.then(key => {
   return fetch(`https://public.tableau.com/vizql/w/DraftRespDash/v/RespDash/tempfile/sessions/${session}/?key=${key}&keepfile=yes&attachment=yes`, {
  "headers": {
    "accept": "*/*",
    "accept-language": "en-US,en;q=0.7",
    "priority": "u=1, i",
    "sec-ch-ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Brave\";v=\"138\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"macOS\"",
    "sec-fetch-dest": "empty",
    "sec-fetch-mode": "cors",
    "sec-fetch-site": "same-origin",
    "sec-gpc": "1",
    "x-b3-sampled": "1",
    "x-b3-spanid": "f925448a5bb971869ffdd6c7ae61b554",
    "x-b3-traceid": "08a0e4af3296bae9c4434f0ba7932849",
    "x-requested-with": "XMLHttpRequest",
    "x-tableau-version": "2025.2",
    "x-tsi-active-tab": "RespDash"
  },
  "referrer": "https://public.tableau.com/views/DraftRespDash/RespDash?%3Adisplay_static_image=y&%3AbootstrapWhenNotified=true&%3Aembed=true&%3Alanguage=en-US&:embed=y&:showVizHome=n&:apiID=host0",
  "body": null,
  "method": "GET",
  "mode": "cors",
  "credentials": "include"
});
})

.then(res => res.text())

.then(console.log) // here's the csv

.catch(console.error)
```

Possible example code to extract this
from tableauhyperapi import HyperProcess, Connection, Telemetry, TableName

# Path to your .hyper file
hyper_path = "path/to/yourfile.hyper"

# Start Hyper API process
with HyperProcess(telemetry=Telemetry.DO_NOT_SEND_USAGE_DATA_TO_TABLEAU) as hyper:
    with Connection(endpoint=hyper.endpoint, database=hyper_path) as connection:
        # List all tables
        tables = connection.catalog.get_table_names("Extract")
        for table in tables:
            print(f"Reading from table: {table}")

            # Query all rows
            result = connection.execute_list_query(f"SELECT * FROM {table}")
            for row in result:
                print(row)
